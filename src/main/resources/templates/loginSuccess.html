<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center">환영합니다!</h1>
    <!-- 타임리프를 사용하여 서버에서 데이터 전달 -->
    <p id="welcomeMessage" class="text-center" th:text="'로그인 성공!'"></p>
    <div class="text-center mt-4">
        <button id="logoutBtn" class="btn btn-danger">로그아웃</button>
    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const token = getCookie("Authorization");
        console.log(token);
        if (!token) {
            alert("로그인이 필요합니다.");
            console.log(token);
            console.log("ww");
            window.location.href = "/login";
            return;
        }

        document.getElementById("logoutBtn").addEventListener("click", function () {
            fetch('/api/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data.message); // "로그아웃 되었습니다."
                    window.location.href = "/login";
                })
                .catch(error => console.error('로그아웃 실패:', error));
        });
    });

    // 쿠키에서 특정 이름의 값을 가져오는 함수
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
    }

    // 쿠키에서 특정 이름의 값을 삭제하는 함수
    function deleteCookie(name) {
        document.cookie = name + '=; Max-Age=-99999999;';
    }
</script>
</body>
</html>
